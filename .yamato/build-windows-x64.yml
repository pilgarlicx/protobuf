name: Build protobuf - Windows 10 x64

agent:
  type: Unity::VM
  image: desktop/desktop-vs2019:latest
  flavor: b1.medium

artifacts:
  build:
    paths:
      - install/**

commands:
  -  |
    "C:\Program Files (x86)\Microsoft Visual Studio\2019\Professional\VC\Auxiliary\Build\vcvars64.bat"
    mkdir install
    cd cmake
    mkdir build
    cd build
    mkdir release
    cd release
    cmake -G "NMake Makefiles" -DCMAKE_BUILD_TYPE=Release -DCMAKE_INSTALL_PREFIX=../../../../install ../..
    nmake
    nmake install